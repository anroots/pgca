<?xml version="1.0" encoding="UTF-8" ?>
<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <services>

        <service id="config" class="Anroots\Pgca\Config">
            <call method="load"/>
        </service>
        <service id="commit.analyzer.ruleSetConfigurator" class="Anroots\Pgca\Commit\Analyzer\RuleSetConfigurator"
                 public="false">
            <argument type="service" id="service_container"/>
            <argument type="service" id="config"/>
        </service>

        <service id="commit.analyzer.abstractAnalyzer" abstract="true"
                 class="Anroots\Pgca\Commit\Analyzer\AbstractAnalyzer">
            <argument type="service" id="report"/>
            <configurator service="commit.analyzer.ruleSetConfigurator" method="loadRules"/>
        </service>
        <service id="commit.analyzer.messageAnalyzer" class="Anroots\Pgca\Commit\Analyzer\MessageAnalyzer"
                 parent="commit.analyzer.abstractAnalyzer"/>


        <service id="git.commit.factory" class="Anroots\Pgca\Git\Commit\Factory"/>


        <service id="report" class="Anroots\Pgca\Report"/>
        <service id="rule.violationFactory" class="Anroots\Pgca\Rule\ViolationFactory"/>

        <service id="abstractCollectionFactory" abstract="true">
            <argument type="service" id="service_container" />
        </service>

        <service id="commit.filter.filterSetFactory" class="Anroots\Pgca\Commit\Filter\FilterSetFactory"
                parent="abstractCollectionFactory"/>

        <!-- Filters -->
        <service id="commit.filter.mergeFilter" class="Anroots\Pgca\Commit\Filter\MergeFilter" />
        <service id="commit.filter.containsRegexFilter" class="Anroots\Pgca\Commit\Filter\ContainsRegexFilter" />

        <!-- Providers -->
        <service id="commit.provider.abstractProvider" class="Anroots\Pgca\Commit\Provider\AbstractProvider"
                 abstract="true">
            <argument type="service" id="git.commit.factory"/>
        </service>

        <service id="commit.provider.fileSystemProvider" class="Anroots\Pgca\Commit\Provider\FileSystemProvider"
                parent="commit.provider.abstractProvider">
        </service>


        <!-- Rules -->
        <service id="rule.abstractRule" abstract="true"
                 class="Anroots\Pgca\Rule\AbstractRule">
            <argument type="service" id="rule.violationFactory"/>

        </service>

        <service id="rule.message.hasSummaryAndDescription" parent="rule.abstractRule"
                 class="Anroots\Pgca\Rule\Message\HasSummaryAndDescriptionRule"/>
        <service id="rule.message.isReallyShort" parent="rule.abstractRule"
                 class="Anroots\Pgca\Rule\Message\IsReallyShortRule"/>
        <service id="rule.message.startsWithCapitalLetter" parent="rule.abstractRule"
                 class="Anroots\Pgca\Rule\Message\StartsWithCapitalLetterRule"/>

    </services>
</container>