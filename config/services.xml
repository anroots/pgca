<?xml version="1.0" encoding="UTF-8" ?>
<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <services>

        <service id="config" class="Anroots\Pgca\Config">
            <call method="load"/>
        </service>

        <service id="abstractSetConfigurator" abstract="true">
            <argument type="service" id="service_container"/>
            <argument type="service" id="config"/>
        </service>

        <service id="commit.analyzer.ruleSetConfigurator" class="Anroots\Pgca\Commit\Analyzer\RuleSetConfigurator"
                 parent="abstractSetConfigurator"/>

        <service id="commit.provider.filterSetConfigurator" class="Anroots\Pgca\Commit\Provider\FilterSetConfigurator"
                 parent="abstractSetConfigurator"/>


        <service id="commit.analyzer.analyzer" class="Anroots\Pgca\Commit\Analyzer\Analyzer">
            <argument type="service" id="report"/>
            <configurator service="commit.analyzer.ruleSetConfigurator" method="load"/>
        </service>

        <service id="git.commit.factory" class="Anroots\Pgca\Git\Commit\Factory"/>


        <service id="report" class="Anroots\Pgca\Report"/>
        <service id="rule.violationFactory" class="Anroots\Pgca\Rule\ViolationFactory"/>

        <!-- Filters -->
        <service id="commit.filter.isNotMergeCommit" class="Anroots\Pgca\Commit\Filter\IsNotMergeCommit"/>
        <service id="commit.filter.containsRegex" class="Anroots\Pgca\Commit\Filter\ContainsRegex"/>

        <!-- Report -->
        <service id="report.simpleConsoleReport" class="Anroots\Pgca\Report\SimpleConsoleReport" />

        <!-- Providers -->
        <service id="commit.provider.abstractProvider" class="Anroots\Pgca\Commit\Provider\AbstractProvider"
                 abstract="true">
            <argument type="service" id="git.commit.factory"/>
            <configurator service="commit.provider.filterSetConfigurator" method="load"/>
        </service>

        <service id="github.client" class="Github\Client" public="false" />

        <service id="commit.provider.fileSystemProvider" class="Anroots\Pgca\Commit\Provider\FileSystemProvider"
                 parent="commit.provider.abstractProvider" />
        <service id="commit.provider.gitHubProvider" class="Anroots\Pgca\Commit\Provider\GitHubProvider"
                 parent="commit.provider.abstractProvider">
                <argument type="service" id="github.client" />
        </service>


        <!-- Rules -->
        <service id="rule.abstractRule" abstract="true"
                 class="Anroots\Pgca\Rule\AbstractRule">
            <argument type="service" id="rule.violationFactory"/>

        </service>

        <service id="rule.message.hasSummaryAndDescription" parent="rule.abstractRule"
                 class="Anroots\Pgca\Rule\Message\HasSummaryAndDescription"/>
        <service id="rule.message.isTooShort" parent="rule.abstractRule"
                 class="Anroots\Pgca\Rule\Message\IsTooShort"/>
        <service id="rule.message.startsWithCapitalLetter" parent="rule.abstractRule"
                 class="Anroots\Pgca\Rule\Message\StartsWithCapitalLetter"/>

    </services>
</container>